<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Nim | gibbr.org</title>
  <style>
    code{white-space: pre-wrap;}
    span.smallcaps{font-variant: small-caps;}
    span.underline{text-decoration: underline;}
    div.column{display: inline-block; vertical-align: top; width: 50%;}
    div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
    ul.task-list{list-style: none;}
    pre > code.sourceCode { white-space: pre; position: relative; }
    pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
    pre > code.sourceCode > span:empty { height: 1.2em; }
    .sourceCode { overflow: visible; }
    code.sourceCode > span { color: inherit; text-decoration: inherit; }
    div.sourceCode { margin: 1em 0; }
    pre.sourceCode { margin: 0; }
    @media screen {
    div.sourceCode { overflow: auto; }
    }
    @media print {
    pre > code.sourceCode { white-space: pre-wrap; }
    pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
    }
    pre.numberSource code
      { counter-reset: source-line 0; }
    pre.numberSource code > span
      { position: relative; left: -4em; counter-increment: source-line; }
    pre.numberSource code > span > a:first-child::before
      { content: counter(source-line);
        position: relative; left: -1em; text-align: right; vertical-align: baseline;
        border: none; display: inline-block;
        -webkit-touch-callout: none; -webkit-user-select: none;
        -khtml-user-select: none; -moz-user-select: none;
        -ms-user-select: none; user-select: none;
        padding: 0 4px; width: 4em;
        color: #aaaaaa;
      }
    pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
    div.sourceCode
      {   }
    @media screen {
    pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
    }
    code span.al { color: #ff0000; font-weight: bold; } /* Alert */
    code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
    code span.at { color: #7d9029; } /* Attribute */
    code span.bn { color: #40a070; } /* BaseN */
    code span.bu { color: #008000; } /* BuiltIn */
    code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
    code span.ch { color: #4070a0; } /* Char */
    code span.cn { color: #880000; } /* Constant */
    code span.co { color: #60a0b0; font-style: italic; } /* Comment */
    code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
    code span.do { color: #ba2121; font-style: italic; } /* Documentation */
    code span.dt { color: #902000; } /* DataType */
    code span.dv { color: #40a070; } /* DecVal */
    code span.er { color: #ff0000; font-weight: bold; } /* Error */
    code span.ex { } /* Extension */
    code span.fl { color: #40a070; } /* Float */
    code span.fu { color: #06287e; } /* Function */
    code span.im { color: #008000; font-weight: bold; } /* Import */
    code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
    code span.kw { color: #007020; font-weight: bold; } /* Keyword */
    code span.op { color: #666666; } /* Operator */
    code span.ot { color: #007020; } /* Other */
    code span.pp { color: #bc7a00; } /* Preprocessor */
    code span.sc { color: #4070a0; } /* SpecialChar */
    code span.ss { color: #bb6688; } /* SpecialString */
    code span.st { color: #4070a0; } /* String */
    code span.va { color: #19177c; } /* Variable */
    code span.vs { color: #4070a0; } /* VerbatimString */
    code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
    .display.math{display: block; text-align: center; margin: 0.5rem auto;}
  </style>
  <link rel="stylesheet" href="../../style.css" />
  <link rel="shortcut icon" href="/favicon.ico">
  <!--[if lt IE 9]>
    <script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7.3/html5shiv-printshiv.min.js"></script>
  <![endif]-->
</head>
<body>
<ul class="navbar" id="navbar">
<li>
<a href="/">home</a>
</li>
<li>
<a href="/blog/">blog</a>
</li>
<li>
<a href="/links.html">links</a>
</li>
</ul>
<h1 id="nim"><a href="#nim" class="anchor"
aria-hidden="true">Nim</a></h1>
<p>Name is a game that is very close and dear to my heart, despite not
having played it in over 5 years. I recently had the good fortune to
attended a talk by Simon Peyton Jones titled “Immutability changes
everything: 40 years of functional programming” which chronologic
Simon’s life and research career. Simon is a self-described one trick
pony, where that trick is functional programming. However, this trick
has taken him from being a major instigator in Haskell - he remains a
lead developer of the Glasgow Haskell Compiler to this day - to
Microsoft research, and more recently to Epic Games working on a new
programming language dubbed ‘<a
href="https://discourse.haskell.org/t/an-epic-future-for-spj/3573">Verse</a>’.
The initial spark for this journey was the game Nim.</p>
<figure>
<img src="dalle2.png" style="width:50.0%" alt="" />
<figcaption aria-hidden="true"><a href="#fn1" class="footnote-ref"
id="fnref1" role="doc-noteref"><sup>1</sup></a></figcaption>
</figure>
<h3 id="the-game"><a href="#the-game" class="anchor"
aria-hidden="true">The game</a></h3>
<p>Picture the scene: you and your opponent stare each other down across
stacks of gold doubloons. You place a wager, you’ll each take turns
taking 1 or more coins from a single pile, and whoever takes the last
coin wins.</p>
<p>Let’s think through your strategy…</p>
<p>To start with a very simple scenario consider two stacks; one with 2
coins, and one with 3 coins.</p>
<p><img src="nim1.svg" style="width:30.0%" /></p>
<p>If you take all of one pile:</p>
<p><img src="nim2.svg" style="width:30.0%" /></p>
<p>Then your opponent can take all off the other, leaving you
penniless:</p>
<p><img src="nim3.svg" style="width:30.0%" /></p>
<p>Let’s rethink…</p>
<p>Instead, if you take one from the pile of three to make the piles
equal:</p>
<p><img src="nim4.svg" style="width:30.0%" /></p>
<p>Then if your opponent takes all of either pile, you can just take the
remaining pile. But let’s imagine they are slightly more canny and they
only take one from a pile:</p>
<p><img src="nim5.svg" style="width:30.0%" /></p>
<p>It seemed to have worked last time, so let’s repeat our trick of
making the piles equal:</p>
<p><img src="nim6.svg" style="width:30.0%" /></p>
<p>Your opponent will be forced to take one coin:</p>
<p><img src="nim7.svg" style="width:30.0%" /></p>
<p>And then fortunes are yours!</p>
<p><img src="nim8.svg" style="width:30.0%" /></p>
<h3 id="a-strategy"><a href="#a-strategy" class="anchor"
aria-hidden="true">A strategy</a></h3>
<p>Nim is a solved game for an arbitrary number of stacks. We can use a
a <em>binary digital sum</em>, denoted the ‘’nim-sum’ to come up with an
optimal strategy. That is, a sum – ignoring carrying – of the binary
values for every stack size. Another word for this operation is
‘exclusve or’ (⊕). For stacks A size 5, B size 2, and C size 3, this is
equal to A⊕B⊕C:</p>
<pre>
A⊕B⊕C
=5<sub>10</sub>⊕2<sub>10</sub>⊕3<sub>10</sub>
=101<sub>2</sub>⊕010<sub>2</sub>⊕011<sub>2</sub>
=111<sub>2</sub>⊕011<sub>2</sub>
=100<sub>2</sub>
=4<sub>10</sub>
</pre>
<p>The key to Nim is to always finish your turn with a num-sum of 0.
This is always possible as long as the nim-sum isn’t 0 at the start of
your turn. The the nim-sum will always be less than the value of the
largest stack, so you can take the decimal value of the Nim sum from
this (or another) stack - which will result in a nim-sum of zero. If the
nim-sum is already zero, taking any coin will make that no longer the
case.</p>
<p>The player who can win the game will be the player with a zero
nim-sum on their last turn, which is predicated on them having a zero
nim-sum (and their opponent always having a non-zero nim-sum) on their
turn from the beginning. You will note, that this makes the outcome of
the game entirely deterministic on the initially state of the board and
whoever has the first turn.</p>
<h3 id="some-reflections"><a href="#some-reflections" class="anchor"
aria-hidden="true">Some reflections</a></h3>
<p>Now at the start of this I alluded to the fact that I was already
familiar with this Game. In fact, as part of my S6<a href="#fn2"
class="footnote-ref" id="fnref2" role="doc-noteref"><sup>2</sup></a>
advanced higher computing project I implemented the game Nim.</p>
<p>As part of this I implemented a crude AI opponent which played
optimally using the nim-sum with some probability based on a
difficulty:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode c#"><code class="sourceCode cs"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="kw">private</span> <span class="dt">void</span> <span class="fu">AITurn</span><span class="op">()</span> <span class="op">{</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span> nim_sum <span class="op">=</span> <span class="bn">0x0</span><span class="op">;</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    <span class="dt">int</span><span class="op">[]</span> Stacks_binary_values <span class="op">=</span> <span class="kw">new</span> <span class="dt">int</span><span class="op">[</span>number_of_stacks<span class="op">];</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="kw">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> number_of_stacks<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>        Stacks_binary_values<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> Convert<span class="op">.</span><span class="fu">ToByte</span><span class="op">(</span>Stacks<span class="op">[</span>i<span class="op">].</span><span class="fu">Text</span><span class="op">);</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>        nim_sum <span class="op">=</span> nim_sum <span class="op">^</span> Stacks_binary_values<span class="op">[</span>i<span class="op">];</span>stacks binary values</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="kw">if</span> <span class="op">(</span>nim_sum <span class="op">==</span> <span class="bn">0x0</span> <span class="op">||</span> random<span class="op">.</span><span class="fu">NextDouble</span><span class="op">()</span> <span class="op">&gt;</span> AIdifficulty<span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>        <span class="dt">int</span> stack_index <span class="op">=</span> random<span class="op">.</span><span class="fu">Next</span><span class="op">(</span>number_of_stacks<span class="op">);</span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>        Stacks<span class="op">[</span>stack_index<span class="op">].</span><span class="fu">Text</span> <span class="op">=</span> random<span class="op">.</span><span class="fu">Next</span><span class="op">(</span><span class="dt">int</span><span class="op">.</span><span class="fu">Parse</span><span class="op">(</span>Stacks<span class="op">[</span>stack_index<span class="op">].</span><span class="fu">Text</span><span class="op">)-</span><span class="dv">1</span><span class="op">).</span><span class="fu">ToString</span><span class="op">();</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>        <span class="kw">if</span> <span class="op">(</span>Stacks<span class="op">[</span>stack_index<span class="op">].</span><span class="fu">Text</span> <span class="op">==</span> <span class="st">&quot;0&quot;</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>            Stacks<span class="op">[</span>stack_index<span class="op">].</span><span class="fu">Hide</span><span class="op">();</span></span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>            Disks<span class="op">[</span>stack_index<span class="op">].</span><span class="fu">Hide</span><span class="op">();</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>        current_stack <span class="op">=</span> stack_index <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>        <span class="kw">for</span> <span class="op">(</span><span class="dt">int</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> number_of_stacks<span class="op">;</span> i<span class="op">++)</span> <span class="op">{</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>            <span class="kw">if</span> <span class="op">((</span>nim_sum <span class="op">^</span> Stacks_binary_values<span class="op">[</span>i<span class="op">])</span> <span class="op">&lt;</span> Stacks_binary_values<span class="op">[</span>i<span class="op">])</span> <span class="op">{</span></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>                Stacks_binary_values<span class="op">[</span>i<span class="op">]</span> <span class="op">=</span> nim_sum <span class="op">^</span> Stacks_binary_values<span class="op">[</span>i<span class="op">];</span></span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>                Stacks<span class="op">[</span>i<span class="op">].</span><span class="fu">Text</span> <span class="op">=</span> Convert<span class="op">.</span><span class="fu">ToString</span><span class="op">(</span>Stacks_binary_values<span class="op">[</span>i<span class="op">]);</span></span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>                <span class="kw">if</span> <span class="op">(</span>Stacks<span class="op">[</span>i<span class="op">].</span><span class="fu">Text</span> <span class="op">==</span> <span class="st">&quot;0&quot;</span><span class="op">)</span> <span class="op">{</span></span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>                    Stacks<span class="op">[</span>i<span class="op">].</span><span class="fu">Hide</span><span class="op">();</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>                    Disks<span class="op">[</span>i<span class="op">].</span><span class="fu">Hide</span><span class="op">();</span></span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>                <span class="op">}</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>                current_stack <span class="op">=</span> i <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>                <span class="kw">break</span><span class="op">;</span></span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>            <span class="op">}</span></span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>        <span class="op">}</span></span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>    <span class="op">}</span></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">TurnTaken</span><span class="op">();</span></span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a><span class="op">}</span></span></code></pre></div>
<p>At the time I only really knew how to program in Visual Studio, and
wanting to move away from visual basic C# was the natural choice. I
believe they even use the same intermediate representation.</p>
<p>The source code and binary (but build instructions are left as an
exercise for the reader) of this game can be found <a
href="https://github.com/RyanGibb/nim">here</a>.</p>
<p>Reflecting on this project, while it had some inane requirements -
like writing out the entire program in pseuocode beforehand and using a
strict waterful methodology, all of which was done retrospectivly of
course - but it really got me to consider studying computer science
further, which led me to where I am today.</p>
<section class="footnotes footnotes-end-of-document"
role="doc-endnotes">
<hr />
<ol>
<li id="fn1" role="doc-endnote"><p>Generated by <a
href="https://openai.com/dall-e-2/">DALL.E 2</a><a href="#fnref1"
class="footnote-back" role="doc-backlink">↩︎</a></p></li>
<li id="fn2" role="doc-endnote"><p>S6 meaning senior phase 6, as I just
found out.<a href="#fnref2" class="footnote-back"
role="doc-backlink">↩︎</a></p></li>
</ol>
</section>
</body>
</html>
